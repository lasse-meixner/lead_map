---
title: "Lead exposure risk in Leeds"
author: "Lead Map Project Team"
format: revealjs
execute:
  echo: true
  cache: true
jupyter: lead_map
---

## Introduction

Goals of this presentation
- why is Leeds a good place to test kids for lead?
- what do we know about kids in Leeds?
- what do we know about risk factors in Leeds?

# Data
## UK MSOA data
We collect a series of demographic, socioeconomic, and environmental variables at the MSOA level.
<!-- general intro slide: what is an msoa? preview of the variables we will look at -->

## Distribution of kids
<!-- plot number of kids in various age groups across leeds map -->

## Risk factors
<!-- Introduce risk factors one by one, list their source, and why we think it is related to lead (e.g. building period, because lead paint was in frequent use prior to year Y etc.) -->


# Geospatial analysis of risk factors
<!-- plot risk factors one by one, each time showing geospatial distribution across leeds as well as a barplot of distribution in leeds vs rest of UK  -->

## Kids
- We have geospatial info on the number of kids
- we have geospatial info on the proportion of families with kids by age of the parents

<!-- re slack discussion: We can compute more variables that explicitly show distribution by ages of kids. should we? do we care about the age of parents? -->

## Number of kids
```{python}
#| label: geospatial-analysis
#| echo: false

from plotting_functions import *

import sys
sys.path.append('../UK/predictors/exploration')
from shapefile_loading import get_msoa_merged_shapefile

merged, cols = get_msoa_merged_shapefile(path_relative_to_UK="../UK/predictors")
```

```{python}
#| label: kids-comparison
#| echo: false

fig = plot_histograms("total_kids_2011", merged, "Leeds", n_bins = 26)
fig.update_layout(title_text="Leeds has more kids relative to the UK")
fig.show()
```

## Location of kids

```{python}
#| label: kids-location
#| echo: false

fig = plot_chloropleth("total_kids_2011", merged, "Leeds")
fig.update_layout(title_text="Distribution of kids in Leeds")
fig.show()
```

## Location of families by age of parents
- average ages of parents correlate very highly with income and median house prices
- the average age of parents is lowest in the center of Leeds

# Housing
## Housing age

```{python}
#| label: housing-age-comparison
#| echo: false

fig = plot_histograms("bp_pre_1954_prop", merged, "Leeds", n_bins = 20)
fig.update_layout(title_text="Leeds has older housing relative to the UK")
fig.show()
```

## Location of older housing stock
```{python}
#| label: housing-age-location
#| echo: false

fig = plot_chloropleth("bp_pre_1954_prop", merged, "Leeds")
fig.update_layout(title_text="Distribution of older housing in Leeds")
fig.show()
```

## Location of house prices
- House prices are highest in the north
- Median house prices 2017-2021 have tripled since 1995-2000

```{python}
#| label: house-prices-location
#| echo: false

fig = plot_chloropleth("house_price_mean_median_2017to2021", merged, "Leeds")
fig.update_layout(title_text="Distribution of house prices in Leeds")
fig.show()
```


# Deprivation

## Location of high incomes

- The outskirts are richer than the center, especially the north
- Except for the old town, the center is poorer
```{python}
#| label: high-income-location
#| echo: false

fig = plot_chloropleth("median_annual_incomeE", merged, "Leeds")
fig.update_layout(title="Median annual incomes (estimated)")
fig.show()
```

## Poverty rate
- Poverty rates in Leeds have a heavier tail then the UK
- Poverty rates are increasing towards the center
```{python}
#| label: poverty-comparison
#| echo: false

fig = plot_CDFs("poverty_rateE", merged, "Leeds")
fig.update_layout(title="Leeds has higher poverty rate relative to the UK")
fig.show()
```

## Location of poverty
```{python}
#| label: poverty-location
#| echo: false

fig = plot_chloropleth("poverty_rateE", merged, "Leeds")
fig.update_layout(title="The center of Leeds is poorest")
fig.show()
```

## Minority population
- The population of black people is concentrated in the north of the center
- High correlation with poverty

<!-- add correlation plot -->

# Pollution
## Soil lead

<!-- add soil lead plot? -->

# Hazard Map

## Efforts by Public Health England
<!-- describe their approach, and then describe how we expand it: more granular analysis (MSOA isntead of LAD), more risk variables of choice, and less wasteful risk function (dont throw out info by computing discrete deciles) -->

## Risk map
<!-- show the risk map, and then show the risk map with the number of kids in each MSOA overlaid -->
